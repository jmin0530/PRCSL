Taskcla:  [(0, 3), (1, 2), (2, 2)]
Number of clients each task:  [10, 10, 10]
************************************************************************************************************
Task  0
************************************************************************************************************
 Epoch: 1 | Train: time= 95.8s | Valid: time= 14.9s loss=1.092, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 88.5s | Valid: time= 15.0s loss=0.826, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 83.6s | Valid: time= 13.2s loss=0.650, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 78.3s | Valid: time= 14.0s loss=0.838, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 83.9s | Valid: time= 14.1s loss=0.822, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 86.9s | Valid: time= 15.6s loss=0.657, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 90.2s | Valid: time= 14.2s loss=0.914, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 77.4s | Valid: time= 12.9s loss=0.690, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 76.0s | Valid: time= 13.6s loss=0.918, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 81.6s | Valid: time= 14.6s loss=0.820, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 85.7s | Valid: time= 14.7s loss=0.769, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 90.3s | Valid: time= 15.5s loss=1.091, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 96.0s | Valid: time= 16.3s loss=1.138, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 92.3s | Valid: time= 15.2s loss=1.139, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 91.2s | Valid: time= 15.1s loss=1.099, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 90.2s | Valid: time= 13.4s loss=1.104, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 73.8s | Valid: time= 13.2s loss=1.139, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 82.6s | Valid: time= 14.1s loss=1.197, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 85.9s | Valid: time= 14.0s loss=1.180, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 84.8s | Valid: time= 13.1s loss=1.115, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 75.7s | Valid: time= 13.3s loss=1.171, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 73.2s | Valid: time= 12.9s loss=1.413, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 75.1s | Valid: time= 13.2s loss=1.415, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 77.1s | Valid: time= 15.1s loss=1.424, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 84.0s | Valid: time= 14.7s loss=1.249, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 85.0s | Valid: time= 14.7s loss=1.270, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 80.7s | Valid: time= 12.6s loss=1.243, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 69.7s | Valid: time= 12.7s loss=1.270, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 74.3s | Valid: time= 13.4s loss=1.257, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 75.3s | Valid: time= 12.8s loss=1.598, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 77.5s | Valid: time= 13.3s loss=1.362, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 81.9s | Valid: time= 13.6s loss=1.517, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 74.8s | Valid: time= 13.1s loss=1.400, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 75.2s | Valid: time= 12.6s loss=1.328, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 74.7s | Valid: time= 13.2s loss=1.226, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 75.8s | Valid: time= 13.2s loss=1.234, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 75.1s | Valid: time= 14.5s loss=1.209, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 83.4s | Valid: time= 13.5s loss=1.229, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 75.2s | Valid: time= 13.6s loss=1.240, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 75.3s | Valid: time= 13.7s loss=1.208, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 75.2s | Valid: time= 13.2s loss=1.210, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 74.9s | Valid: time= 13.5s loss=1.214, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 74.8s | Valid: time= 13.2s loss=1.220, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 77.5s | Valid: time= 15.0s loss=1.225, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 73.3s | Valid: time= 13.5s loss=1.223, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 75.9s | Valid: time= 13.1s loss=1.218, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 71.4s | Valid: time= 12.9s loss=1.226, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 73.6s | Valid: time= 12.8s loss=1.228, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 73.6s | Valid: time= 13.3s loss=1.208, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 72.6s | Valid: time= 12.3s loss=1.224, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 180 train exemplars, time=115.9s
| Constructed 180 exemplars
Final memory length:  60
self.logits length and one shape:  60 (7,)
Previous classes:  [0 1 2]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=0.965 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 83.2%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_4
************************************************************************************************************
Task  1
************************************************************************************************************
 Epoch: 1 | Train: time= 56.0s | Valid: time= 11.0s loss=1.147, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 54.3s | Valid: time= 10.9s loss=0.897, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 55.4s | Valid: time= 11.4s loss=1.106, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 53.8s | Valid: time= 10.4s loss=1.870, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 49.0s | Valid: time= 10.3s loss=0.876, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 47.7s | Valid: time= 10.6s loss=3.169, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 48.2s | Valid: time= 10.4s loss=0.860, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 49.8s | Valid: time= 11.3s loss=0.569, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 51.8s | Valid: time= 10.2s loss=0.654, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 46.4s | Valid: time= 10.5s loss=1.178, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 47.3s | Valid: time= 10.2s loss=0.607, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 46.5s | Valid: time= 10.4s loss=0.508, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 46.9s | Valid: time= 10.5s loss=0.715, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 47.8s | Valid: time= 10.5s loss=0.561, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 48.1s | Valid: time= 10.4s loss=0.537, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 47.5s | Valid: time= 10.3s loss=0.445, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 47.4s | Valid: time= 10.0s loss=0.492, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 46.6s | Valid: time= 10.2s loss=0.443, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 52.9s | Valid: time= 11.5s loss=0.567, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 56.4s | Valid: time= 11.1s loss=0.627, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 54.6s | Valid: time= 11.0s loss=0.395, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 55.7s | Valid: time= 11.8s loss=0.403, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 54.7s | Valid: time= 11.8s loss=0.418, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 54.8s | Valid: time= 11.6s loss=0.392, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 48.9s | Valid: time= 10.1s loss=0.411, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 45.2s | Valid: time=  9.9s loss=0.469, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 45.7s | Valid: time= 10.5s loss=0.462, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 51.7s | Valid: time= 11.2s loss=0.444, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 53.0s | Valid: time= 11.1s loss=0.653, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 52.5s | Valid: time= 11.5s loss=0.420, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 46.5s | Valid: time= 10.4s loss=0.409, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 45.9s | Valid: time=  9.8s loss=0.453, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 47.1s | Valid: time=  9.9s loss=0.454, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 46.3s | Valid: time= 10.0s loss=0.427, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 45.6s | Valid: time= 10.1s loss=0.401, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 46.4s | Valid: time=  9.9s loss=0.407, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 46.1s | Valid: time= 10.0s loss=0.401, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 45.9s | Valid: time= 11.6s loss=0.404, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 54.6s | Valid: time= 10.8s loss=0.390, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 53.4s | Valid: time= 10.7s loss=0.389, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 54.2s | Valid: time= 10.9s loss=0.391, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 45.2s | Valid: time= 10.2s loss=0.381, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 45.3s | Valid: time= 10.0s loss=0.389, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 44.7s | Valid: time= 10.1s loss=0.400, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 46.1s | Valid: time= 10.3s loss=0.394, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 45.6s | Valid: time=  9.8s loss=0.386, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 46.2s | Valid: time= 10.1s loss=0.390, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 46.8s | Valid: time= 10.0s loss=0.387, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 45.2s | Valid: time= 10.5s loss=0.419, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 52.6s | Valid: time= 11.0s loss=0.395, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 119 train exemplars, time= 80.6s
| Constructed 179 exemplars
Final memory length:  100
self.logits length and one shape:  100 (7,)
Previous classes:  [0 1 2 3 4]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=6.706 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.4%, forg= 82.8% <<<
>>> Test on task  1 : loss=0.932 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 82.7%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_4
************************************************************************************************************
Task  2
************************************************************************************************************
 Epoch: 1 | Train: time= 51.3s | Valid: time= 11.0s loss=0.555, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 52.7s | Valid: time= 10.8s loss=1.865, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 50.3s | Valid: time= 10.7s loss=3.998, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 44.7s | Valid: time=  9.7s loss=4.793, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 43.4s | Valid: time=  9.6s loss=7.533, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 43.3s | Valid: time=  9.7s loss=1.156, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 47.7s | Valid: time= 10.5s loss=14.761, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 52.5s | Valid: time= 11.0s loss=0.115, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 50.3s | Valid: time= 10.5s loss=0.024, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 51.2s | Valid: time=  9.8s loss=0.040, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 50.9s | Valid: time= 10.9s loss=0.002, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 52.0s | Valid: time= 10.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 47.4s | Valid: time=  9.5s loss=0.003, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 43.9s | Valid: time=  9.0s loss=0.019, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 41.5s | Valid: time=  9.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 41.8s | Valid: time=  9.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 45.5s | Valid: time= 10.2s loss=0.002, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 50.5s | Valid: time= 10.6s loss=0.002, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 50.5s | Valid: time= 10.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 51.0s | Valid: time= 10.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 49.7s | Valid: time= 10.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 50.5s | Valid: time= 11.1s loss=0.001, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 51.3s | Valid: time= 10.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 47.4s | Valid: time=  9.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 44.1s | Valid: time=  9.7s loss=0.001, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 42.9s | Valid: time=  9.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 43.6s | Valid: time=  9.5s loss=0.002, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 47.1s | Valid: time= 10.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 52.2s | Valid: time= 10.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 49.5s | Valid: time= 10.4s loss=0.000, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 51.5s | Valid: time= 10.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 49.4s | Valid: time= 10.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 50.3s | Valid: time=  9.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 42.6s | Valid: time= 10.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 43.1s | Valid: time=  9.5s loss=0.002, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 42.7s | Valid: time=  9.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 42.6s | Valid: time=  9.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 42.5s | Valid: time= 10.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 49.5s | Valid: time= 10.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 48.9s | Valid: time= 10.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 49.8s | Valid: time= 10.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 49.0s | Valid: time= 10.1s loss=0.001, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 51.7s | Valid: time= 10.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 52.3s | Valid: time= 10.1s loss=0.001, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 42.0s | Valid: time=  9.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 42.2s | Valid: time=  9.7s loss=0.001, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 42.2s | Valid: time=  9.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 42.4s | Valid: time=  9.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 51.7s | Valid: time= 10.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 50.2s | Valid: time= 10.2s loss=0.001, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 120 train exemplars, time= 68.8s
| Constructed 220 exemplars
Final memory length:  140
self.logits length and one shape:  140 (7,)
Previous classes:  [0 1 2 3 4 5 6]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=8.435 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 83.2% <<<
>>> Test on task  1 : loss=8.981 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 82.7% <<<
>>> Test on task  2 : loss=0.003 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:100.0%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_4
************************************************************************************************************
TAw Acc
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Acc result
 0.00	 0.00	
************************************************************************************************************
TAg Acc
	83.20%  0.00%  0.00% 	Avg.:83.20% 
	 0.42% 82.69%  0.00% 	Avg.:41.55% 
	 0.00%  0.00% 100.00% 	Avg.:33.33% 
TAg Acc result
83.20	41.55	33.33	
************************************************************************************************************
TAw Forg
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Forg result
 0.00	 0.00	
************************************************************************************************************
TAg Forg
	 0.00%  0.00%  0.00% 
	82.78%  0.00%  0.00% 	Avg.:82.78% 
	83.20% 82.69%  0.00% 	Avg.:82.94% 
TAg Forg result
82.78	82.94	
************************************************************************************************************
[Elapsed time = 3.0 h]
Done!
