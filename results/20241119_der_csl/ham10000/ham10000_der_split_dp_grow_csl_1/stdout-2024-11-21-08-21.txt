Taskcla:  [(0, 3), (1, 2), (2, 2)]
Number of clients each task:  [10, 10, 10]
************************************************************************************************************
Task  0
************************************************************************************************************
 Epoch: 1 | Train: time= 82.1s | Valid: time= 13.0s loss=0.838, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 79.5s | Valid: time= 13.3s loss=0.813, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 80.1s | Valid: time= 13.8s loss=0.642, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 78.2s | Valid: time= 13.3s loss=0.688, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 79.8s | Valid: time= 13.1s loss=0.614, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 81.6s | Valid: time= 13.6s loss=0.692, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 79.2s | Valid: time= 13.5s loss=1.209, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 78.8s | Valid: time= 13.1s loss=1.520, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 79.8s | Valid: time= 13.7s loss=1.015, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 77.7s | Valid: time= 13.5s loss=0.905, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 78.2s | Valid: time= 13.6s loss=0.915, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 79.3s | Valid: time= 13.3s loss=1.082, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 77.6s | Valid: time= 13.6s loss=1.212, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 80.8s | Valid: time= 13.7s loss=1.527, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 79.1s | Valid: time= 14.1s loss=1.346, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 79.4s | Valid: time= 13.8s loss=1.371, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 80.2s | Valid: time= 13.3s loss=1.150, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 79.5s | Valid: time= 13.9s loss=1.637, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 80.3s | Valid: time= 13.8s loss=1.722, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 80.0s | Valid: time= 13.6s loss=1.554, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 76.9s | Valid: time= 13.5s loss=1.306, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 81.5s | Valid: time= 13.5s loss=1.736, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 78.7s | Valid: time= 13.5s loss=1.611, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 79.6s | Valid: time= 12.9s loss=1.336, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 80.0s | Valid: time= 13.8s loss=1.354, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 80.5s | Valid: time= 13.9s loss=1.550, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 79.7s | Valid: time= 13.6s loss=2.128, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 77.8s | Valid: time= 13.6s loss=1.909, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 79.5s | Valid: time= 13.4s loss=1.462, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 82.0s | Valid: time= 13.3s loss=1.642, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 78.9s | Valid: time= 14.0s loss=1.617, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 80.5s | Valid: time= 13.5s loss=1.513, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 80.0s | Valid: time= 13.3s loss=1.416, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 79.7s | Valid: time= 13.4s loss=1.584, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 79.5s | Valid: time= 13.8s loss=1.404, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 80.2s | Valid: time= 13.2s loss=1.384, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 78.6s | Valid: time= 13.2s loss=1.408, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 76.8s | Valid: time= 13.9s loss=1.393, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 80.5s | Valid: time= 13.6s loss=1.396, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 87.7s | Valid: time= 14.7s loss=1.379, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 89.0s | Valid: time= 14.8s loss=1.400, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 89.6s | Valid: time= 14.8s loss=1.407, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 91.1s | Valid: time= 14.2s loss=1.407, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 90.6s | Valid: time= 14.5s loss=1.385, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 90.1s | Valid: time= 15.6s loss=1.405, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 94.1s | Valid: time= 15.5s loss=1.406, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 93.8s | Valid: time= 15.5s loss=1.392, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 95.2s | Valid: time= 15.3s loss=1.400, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 93.9s | Valid: time= 15.7s loss=1.408, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 92.1s | Valid: time= 15.5s loss=1.402, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 180 train exemplars, time=136.9s
| Constructed 180 exemplars
Final memory length:  60
self.logits length and one shape:  60 (7,)
Previous classes:  [0 1 2]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=0.908 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 85.1%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_1
************************************************************************************************************
Task  1
************************************************************************************************************
 Epoch: 1 | Train: time= 62.0s | Valid: time= 12.5s loss=1.943, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 61.2s | Valid: time= 12.4s loss=1.600, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 59.9s | Valid: time= 11.7s loss=4.060, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 54.7s | Valid: time= 12.1s loss=3.574, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 55.9s | Valid: time= 11.5s loss=20.416, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 57.4s | Valid: time= 12.0s loss=5.418, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 60.9s | Valid: time= 11.6s loss=26.559, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 57.8s | Valid: time= 11.0s loss=3.005, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 54.2s | Valid: time= 11.5s loss=6.843, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 60.9s | Valid: time= 12.0s loss=6.185, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 60.8s | Valid: time= 11.4s loss=1.623, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 55.3s | Valid: time= 10.8s loss=0.477, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 55.2s | Valid: time= 11.5s loss=0.690, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 51.5s | Valid: time= 10.3s loss=0.542, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 53.5s | Valid: time= 10.9s loss=0.931, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 57.2s | Valid: time= 11.3s loss=0.827, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 50.7s | Valid: time= 10.0s loss=0.449, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 47.7s | Valid: time= 10.6s loss=0.644, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 52.0s | Valid: time= 11.1s loss=0.525, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 54.1s | Valid: time= 10.5s loss=0.495, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 51.5s | Valid: time= 10.8s loss=0.528, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 53.7s | Valid: time= 10.9s loss=0.504, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 49.4s | Valid: time= 11.8s loss=0.590, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 53.9s | Valid: time= 11.2s loss=0.449, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 58.8s | Valid: time= 11.5s loss=0.478, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 56.9s | Valid: time= 11.7s loss=0.509, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 54.8s | Valid: time= 11.3s loss=0.578, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 53.5s | Valid: time= 11.3s loss=0.474, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 55.2s | Valid: time= 11.6s loss=0.690, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 51.7s | Valid: time= 10.7s loss=0.666, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 53.5s | Valid: time= 11.8s loss=0.581, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 59.0s | Valid: time= 12.2s loss=0.537, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 63.1s | Valid: time= 11.9s loss=0.617, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 61.5s | Valid: time= 11.8s loss=0.523, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 57.2s | Valid: time= 11.6s loss=0.492, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 54.3s | Valid: time=  9.8s loss=0.481, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 44.8s | Valid: time=  9.5s loss=0.479, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 43.6s | Valid: time=  9.8s loss=0.474, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 43.7s | Valid: time=  9.8s loss=0.474, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 43.7s | Valid: time=  9.5s loss=0.469, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 43.4s | Valid: time=  9.7s loss=0.463, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 47.6s | Valid: time= 10.6s loss=0.466, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 52.4s | Valid: time= 10.7s loss=0.464, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 51.9s | Valid: time= 10.5s loss=0.462, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 49.2s | Valid: time=  9.8s loss=0.460, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 44.3s | Valid: time= 10.0s loss=0.466, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 43.6s | Valid: time=  9.5s loss=0.460, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 44.0s | Valid: time=  9.9s loss=0.465, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 43.6s | Valid: time=  9.7s loss=0.459, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 44.5s | Valid: time=  9.9s loss=0.459, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 120 train exemplars, time= 65.7s
| Constructed 180 exemplars
Final memory length:  100
self.logits length and one shape:  100 (7,)
Previous classes:  [0 1 2 3 4]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=5.237 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  5.0%, forg= 80.1% <<<
>>> Test on task  1 : loss=0.870 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 80.2%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_1
************************************************************************************************************
Task  2
************************************************************************************************************
 Epoch: 1 | Train: time= 47.2s | Valid: time= 10.2s loss=0.269, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 44.0s | Valid: time=  9.6s loss=0.483, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 41.7s | Valid: time=  9.2s loss=1.112, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 42.6s | Valid: time=  9.4s loss=1.959, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 43.0s | Valid: time=  9.2s loss=9.029, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 42.6s | Valid: time=  9.4s loss=0.093, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 43.0s | Valid: time=  9.1s loss=11.592, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 45.0s | Valid: time=  9.4s loss=0.082, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 42.7s | Valid: time=  9.1s loss=0.009, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 43.4s | Valid: time=  9.1s loss=0.019, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 43.4s | Valid: time=  9.4s loss=0.005, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 45.1s | Valid: time= 10.1s loss=0.004, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 50.8s | Valid: time= 10.3s loss=0.002, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 49.7s | Valid: time= 10.2s loss=0.014, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 50.6s | Valid: time= 10.4s loss=0.002, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 49.6s | Valid: time= 10.4s loss=0.041, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 42.6s | Valid: time=  9.1s loss=0.001, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 41.5s | Valid: time=  9.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 41.0s | Valid: time=  8.9s loss=0.002, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 41.3s | Valid: time=  9.3s loss=0.068, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 41.3s | Valid: time=  9.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 41.5s | Valid: time=  9.2s loss=0.423, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 42.5s | Valid: time= 10.2s loss=16.817, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 48.9s | Valid: time= 10.0s loss=0.486, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 49.2s | Valid: time= 10.1s loss=0.090, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 50.7s | Valid: time= 10.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 49.1s | Valid: time= 10.5s loss=0.003, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 46.8s | Valid: time=  9.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 41.1s | Valid: time=  9.3s loss=3.282, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 41.5s | Valid: time=  9.1s loss=0.017, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 42.0s | Valid: time=  9.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 41.6s | Valid: time=  9.2s loss=0.009, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 41.6s | Valid: time=  9.4s loss=0.002, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 43.7s | Valid: time= 10.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 48.4s | Valid: time= 10.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 48.9s | Valid: time=  9.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 48.1s | Valid: time= 10.2s loss=0.001, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 49.7s | Valid: time=  9.2s loss=0.000, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 41.9s | Valid: time=  9.4s loss=0.000, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 41.7s | Valid: time=  9.0s loss=0.000, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 41.5s | Valid: time=  9.4s loss=0.000, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 41.2s | Valid: time=  9.2s loss=0.000, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 41.7s | Valid: time=  9.1s loss=0.001, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 41.3s | Valid: time=  9.0s loss=0.000, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 41.4s | Valid: time=  9.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 52.0s | Valid: time= 10.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 48.1s | Valid: time= 10.1s loss=0.000, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 50.1s | Valid: time= 10.1s loss=0.000, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 42.5s | Valid: time=  9.6s loss=0.000, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 41.7s | Valid: time=  9.2s loss=0.000, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 120 train exemplars, time= 57.7s
| Constructed 220 exemplars
Final memory length:  140
self.logits length and one shape:  140 (7,)
Previous classes:  [0 1 2 3 4 5 6]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=9.512 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 85.1% <<<
>>> Test on task  1 : loss=9.063 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 80.2% <<<
>>> Test on task  2 : loss=0.001 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:100.0%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_1
************************************************************************************************************
TAw Acc
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Acc result
 0.00	 0.00	
************************************************************************************************************
TAg Acc
	85.14%  0.00%  0.00% 	Avg.:85.14% 
	 5.01% 80.19%  0.00% 	Avg.:42.60% 
	 0.00%  0.00% 100.00% 	Avg.:33.33% 
TAg Acc result
85.14	42.60	33.33	
************************************************************************************************************
TAw Forg
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Forg result
 0.00	 0.00	
************************************************************************************************************
TAg Forg
	 0.00%  0.00%  0.00% 
	80.13%  0.00%  0.00% 	Avg.:80.13% 
	85.14% 80.19%  0.00% 	Avg.:82.67% 
TAg Forg result
80.13	82.67	
************************************************************************************************************
[Elapsed time = 3.1 h]
Done!
