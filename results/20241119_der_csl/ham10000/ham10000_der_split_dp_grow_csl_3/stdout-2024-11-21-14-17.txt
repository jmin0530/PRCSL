Taskcla:  [(0, 3), (1, 2), (2, 2)]
Number of clients each task:  [10, 10, 10]
************************************************************************************************************
Task  0
************************************************************************************************************
 Epoch: 1 | Train: time= 85.0s | Valid: time= 14.1s loss=0.768, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 81.3s | Valid: time= 15.2s loss=0.693, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 89.4s | Valid: time= 14.9s loss=0.791, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 88.8s | Valid: time= 13.9s loss=0.732, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 81.0s | Valid: time= 13.8s loss=0.657, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 80.6s | Valid: time= 14.1s loss=0.852, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 81.1s | Valid: time= 13.8s loss=0.775, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 78.0s | Valid: time= 13.5s loss=0.734, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 87.2s | Valid: time= 14.8s loss=1.029, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 89.3s | Valid: time= 14.9s loss=0.862, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 82.6s | Valid: time= 13.8s loss=1.000, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 79.0s | Valid: time= 14.1s loss=1.372, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 77.8s | Valid: time= 13.8s loss=1.088, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 77.7s | Valid: time= 13.8s loss=1.422, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 85.6s | Valid: time= 14.2s loss=1.381, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 88.2s | Valid: time= 15.0s loss=1.228, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 78.1s | Valid: time= 13.8s loss=1.417, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 78.3s | Valid: time= 14.1s loss=1.190, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 78.2s | Valid: time= 13.8s loss=1.146, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 78.9s | Valid: time= 14.0s loss=1.567, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 81.8s | Valid: time= 15.8s loss=1.155, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 89.2s | Valid: time= 15.0s loss=1.203, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 86.3s | Valid: time= 15.0s loss=1.530, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 80.1s | Valid: time= 14.2s loss=1.386, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 79.7s | Valid: time= 14.5s loss=1.420, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 78.5s | Valid: time= 15.1s loss=1.424, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 84.9s | Valid: time= 17.2s loss=1.490, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 95.6s | Valid: time= 16.5s loss=1.288, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 94.2s | Valid: time= 16.7s loss=1.326, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 86.3s | Valid: time= 15.4s loss=2.199, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 85.1s | Valid: time= 16.1s loss=1.451, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 84.3s | Valid: time= 15.3s loss=2.146, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 91.5s | Valid: time= 16.8s loss=3.512, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 94.0s | Valid: time= 16.6s loss=1.277, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 84.0s | Valid: time= 14.7s loss=1.187, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 80.2s | Valid: time= 15.0s loss=1.169, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 79.7s | Valid: time= 14.9s loss=1.165, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 79.8s | Valid: time= 14.5s loss=1.166, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 83.5s | Valid: time= 14.8s loss=1.188, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 77.7s | Valid: time= 14.1s loss=1.176, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 75.9s | Valid: time= 13.5s loss=1.157, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 73.7s | Valid: time= 14.3s loss=1.184, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 73.5s | Valid: time= 14.0s loss=1.188, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 73.2s | Valid: time= 14.0s loss=1.174, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 74.3s | Valid: time= 13.7s loss=1.185, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 83.0s | Valid: time= 15.0s loss=1.206, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 84.5s | Valid: time= 14.1s loss=1.179, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 73.2s | Valid: time= 14.2s loss=1.183, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 74.8s | Valid: time= 14.2s loss=1.186, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 74.4s | Valid: time= 14.5s loss=1.203, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 180 train exemplars, time=116.6s
| Constructed 180 exemplars
Final memory length:  60
self.logits length and one shape:  60 (7,)
Previous classes:  [0 1 2]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=0.875 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 84.8%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_3
************************************************************************************************************
Task  1
************************************************************************************************************
 Epoch: 1 | Train: time= 54.3s | Valid: time= 12.6s loss=3.993, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 52.1s | Valid: time= 11.4s loss=1.972, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 51.4s | Valid: time= 11.4s loss=2.043, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 55.1s | Valid: time= 13.8s loss=2.165, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 73.2s | Valid: time= 13.9s loss=2.082, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 71.4s | Valid: time= 14.2s loss=2.401, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 69.0s | Valid: time= 13.3s loss=1.462, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 70.4s | Valid: time= 13.8s loss=4.029, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 68.1s | Valid: time= 13.9s loss=2.673, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 66.9s | Valid: time= 13.4s loss=0.952, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 70.0s | Valid: time= 14.3s loss=1.339, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 70.2s | Valid: time= 14.3s loss=0.718, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 71.4s | Valid: time= 14.3s loss=0.542, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 71.5s | Valid: time= 14.2s loss=0.658, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 69.2s | Valid: time= 14.5s loss=0.401, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 70.2s | Valid: time= 14.7s loss=0.415, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 69.4s | Valid: time= 15.6s loss=0.377, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 71.2s | Valid: time= 14.9s loss=0.346, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 70.5s | Valid: time= 15.0s loss=0.340, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 74.4s | Valid: time= 12.7s loss=0.454, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 69.1s | Valid: time= 14.2s loss=8.439, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 67.0s | Valid: time= 14.3s loss=0.428, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 71.0s | Valid: time= 14.1s loss=0.405, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 69.6s | Valid: time= 14.4s loss=0.935, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 69.5s | Valid: time= 14.1s loss=0.328, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 68.2s | Valid: time= 14.4s loss=0.387, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 68.4s | Valid: time= 15.1s loss=0.373, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 67.3s | Valid: time= 14.6s loss=0.364, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 69.1s | Valid: time= 15.0s loss=0.946, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 68.7s | Valid: time= 14.2s loss=0.378, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 66.9s | Valid: time= 13.6s loss=0.376, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 67.7s | Valid: time= 14.6s loss=0.389, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 67.1s | Valid: time= 15.0s loss=0.433, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 69.4s | Valid: time= 13.9s loss=0.378, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 68.3s | Valid: time= 14.1s loss=0.335, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 70.4s | Valid: time= 14.2s loss=0.334, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 70.4s | Valid: time= 14.4s loss=0.334, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 68.3s | Valid: time= 14.1s loss=0.332, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 67.7s | Valid: time= 13.5s loss=0.333, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 70.1s | Valid: time= 14.4s loss=0.341, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 72.4s | Valid: time= 14.9s loss=0.333, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 68.9s | Valid: time= 14.6s loss=0.339, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 72.8s | Valid: time= 14.7s loss=0.341, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 71.0s | Valid: time= 14.7s loss=0.337, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 70.7s | Valid: time= 14.2s loss=0.347, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 68.7s | Valid: time= 14.5s loss=0.334, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 68.9s | Valid: time= 14.8s loss=0.334, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 68.4s | Valid: time= 14.7s loss=0.341, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 68.3s | Valid: time= 14.7s loss=0.344, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 70.3s | Valid: time= 14.5s loss=0.334, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 120 train exemplars, time= 96.1s
| Constructed 180 exemplars
Final memory length:  100
self.logits length and one shape:  100 (7,)
Previous classes:  [0 1 2 3 4]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=6.444 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  2.5%, forg= 82.3% <<<
>>> Test on task  1 : loss=0.757 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 85.2%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_3
************************************************************************************************************
Task  2
************************************************************************************************************
 Epoch: 1 | Train: time= 65.0s | Valid: time= 13.5s loss=0.232, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 64.8s | Valid: time= 13.1s loss=1.181, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 64.1s | Valid: time= 13.4s loss=4.194, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 64.6s | Valid: time= 13.9s loss=0.253, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 66.3s | Valid: time= 14.2s loss=4.077, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 65.4s | Valid: time= 13.3s loss=16.781, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 67.8s | Valid: time= 13.7s loss=0.396, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 67.5s | Valid: time= 13.2s loss=7.083, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 64.4s | Valid: time= 13.4s loss=0.311, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 64.1s | Valid: time= 12.9s loss=0.021, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 60.4s | Valid: time= 13.5s loss=0.006, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 66.9s | Valid: time= 13.4s loss=0.003, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 65.6s | Valid: time= 13.3s loss=0.004, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 65.6s | Valid: time= 13.6s loss=0.002, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 68.0s | Valid: time= 13.5s loss=0.002, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 67.3s | Valid: time= 14.0s loss=0.001, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 66.9s | Valid: time= 13.6s loss=2.166, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 65.0s | Valid: time= 13.8s loss=0.003, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 65.7s | Valid: time= 13.3s loss=0.416, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 64.6s | Valid: time= 12.9s loss=0.852, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 63.2s | Valid: time= 14.5s loss=0.003, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 66.0s | Valid: time= 13.7s loss=0.002, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 67.1s | Valid: time= 13.8s loss=0.002, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 66.1s | Valid: time= 13.4s loss=0.002, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 68.0s | Valid: time= 14.0s loss=0.002, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 67.7s | Valid: time= 14.3s loss=0.004, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 67.6s | Valid: time= 13.8s loss=0.002, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 71.1s | Valid: time= 14.8s loss=0.003, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 70.7s | Valid: time= 14.5s loss=0.000, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 68.9s | Valid: time= 13.9s loss=0.000, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 69.4s | Valid: time= 13.2s loss=1.005, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 70.2s | Valid: time= 14.3s loss=0.004, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 69.0s | Valid: time= 14.3s loss=0.003, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 70.6s | Valid: time= 14.5s loss=0.006, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 70.0s | Valid: time= 13.9s loss=0.005, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 67.9s | Valid: time= 13.8s loss=0.004, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 68.0s | Valid: time= 13.7s loss=0.004, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 67.1s | Valid: time= 13.7s loss=0.004, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 67.2s | Valid: time= 13.8s loss=0.004, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 69.4s | Valid: time= 14.5s loss=0.004, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 67.2s | Valid: time= 14.2s loss=0.004, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 67.0s | Valid: time= 13.7s loss=0.003, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 69.1s | Valid: time= 14.0s loss=0.004, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 70.0s | Valid: time= 14.2s loss=0.004, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 69.0s | Valid: time= 14.3s loss=0.003, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 69.9s | Valid: time= 14.0s loss=0.004, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 68.5s | Valid: time= 14.2s loss=0.004, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 66.3s | Valid: time= 14.7s loss=0.005, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 67.1s | Valid: time= 12.7s loss=0.004, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 65.0s | Valid: time= 12.8s loss=0.003, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 120 train exemplars, time= 84.8s
| Constructed 220 exemplars
Final memory length:  140
self.logits length and one shape:  140 (7,)
Previous classes:  [0 1 2 3 4 5 6]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=8.675 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 84.8% <<<
>>> Test on task  1 : loss=8.573 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 85.2% <<<
>>> Test on task  2 : loss=0.003 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:100.0%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_3
************************************************************************************************************
TAw Acc
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Acc result
 0.00	 0.00	
************************************************************************************************************
TAg Acc
	84.75%  0.00%  0.00% 	Avg.:84.75% 
	 2.50% 85.19%  0.00% 	Avg.:43.85% 
	 0.00%  0.00% 100.00% 	Avg.:33.33% 
TAg Acc result
84.75	43.85	33.33	
************************************************************************************************************
TAw Forg
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Forg result
 0.00	 0.00	
************************************************************************************************************
TAg Forg
	 0.00%  0.00%  0.00% 
	82.25%  0.00%  0.00% 	Avg.:82.25% 
	84.75% 85.19%  0.00% 	Avg.:84.97% 
TAg Forg result
82.25	84.97	
************************************************************************************************************
[Elapsed time = 3.7 h]
Done!
