Taskcla:  [(0, 3), (1, 2), (2, 2)]
Number of clients each task:  [10, 10, 10]
************************************************************************************************************
Task  0
************************************************************************************************************
 Epoch: 1 | Train: time=107.6s | Valid: time= 17.2s loss=0.787, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 95.7s | Valid: time= 16.1s loss=0.937, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 95.9s | Valid: time= 16.0s loss=0.685, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 93.3s | Valid: time= 15.5s loss=0.899, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 94.8s | Valid: time= 15.9s loss=0.619, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 93.1s | Valid: time= 16.4s loss=0.647, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 95.9s | Valid: time= 17.0s loss=0.690, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 94.0s | Valid: time= 16.4s loss=0.686, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 95.7s | Valid: time= 16.0s loss=0.950, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 93.3s | Valid: time= 16.0s loss=1.400, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 93.3s | Valid: time= 16.1s loss=0.967, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 95.1s | Valid: time= 16.2s loss=0.986, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 94.8s | Valid: time= 15.8s loss=1.604, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 95.1s | Valid: time= 16.4s loss=1.000, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 93.1s | Valid: time= 16.0s loss=1.201, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 96.0s | Valid: time= 16.2s loss=1.862, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 95.6s | Valid: time= 16.5s loss=1.131, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 95.7s | Valid: time= 16.2s loss=1.630, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 93.5s | Valid: time= 16.5s loss=1.423, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 94.5s | Valid: time= 16.1s loss=1.342, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 94.4s | Valid: time= 15.8s loss=1.223, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 93.4s | Valid: time= 15.6s loss=1.683, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 93.3s | Valid: time= 17.0s loss=1.341, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 94.8s | Valid: time= 16.2s loss=1.544, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 94.5s | Valid: time= 16.6s loss=1.344, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 94.9s | Valid: time= 17.0s loss=2.089, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 96.0s | Valid: time= 17.0s loss=1.435, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 94.6s | Valid: time= 16.2s loss=1.716, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 92.6s | Valid: time= 16.3s loss=1.410, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 94.3s | Valid: time= 16.2s loss=1.425, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 94.3s | Valid: time= 15.2s loss=1.537, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 95.0s | Valid: time= 16.3s loss=1.759, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 93.5s | Valid: time= 15.9s loss=1.756, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 93.7s | Valid: time= 15.4s loss=1.636, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 95.1s | Valid: time= 15.7s loss=1.319, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 87.1s | Valid: time= 15.6s loss=1.302, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 87.3s | Valid: time= 14.6s loss=1.314, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 85.9s | Valid: time= 14.1s loss=1.289, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 83.4s | Valid: time= 14.6s loss=1.307, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 85.1s | Valid: time= 14.6s loss=1.289, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 83.4s | Valid: time= 14.7s loss=1.309, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 83.3s | Valid: time= 14.3s loss=1.298, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 82.3s | Valid: time= 13.7s loss=1.298, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 82.1s | Valid: time= 14.5s loss=1.307, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 84.1s | Valid: time= 13.8s loss=1.303, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 83.8s | Valid: time= 14.3s loss=1.300, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 83.6s | Valid: time= 14.6s loss=1.291, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 84.7s | Valid: time= 14.3s loss=1.286, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 82.5s | Valid: time= 14.0s loss=1.301, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 82.0s | Valid: time= 14.1s loss=1.298, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 180 train exemplars, time=125.6s
| Constructed 180 exemplars
Final memory length:  60
self.logits length and one shape:  60 (7,)
Previous classes:  [0 1 2]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=0.742 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 85.6%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_0
************************************************************************************************************
Task  1
************************************************************************************************************
 Epoch: 1 | Train: time= 57.9s | Valid: time= 11.4s loss=3.700, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 54.8s | Valid: time= 12.1s loss=2.217, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 58.1s | Valid: time= 11.6s loss=2.299, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 57.1s | Valid: time= 11.0s loss=1.736, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 57.4s | Valid: time= 11.3s loss=2.802, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 54.0s | Valid: time= 12.0s loss=8.685, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 56.1s | Valid: time= 10.9s loss=4.269, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 57.9s | Valid: time= 11.4s loss=4.540, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 57.1s | Valid: time= 11.8s loss=0.496, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 55.9s | Valid: time= 11.7s loss=5.134, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 54.6s | Valid: time= 11.9s loss=1.076, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 56.9s | Valid: time= 11.6s loss=0.543, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 54.4s | Valid: time= 12.0s loss=0.701, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 60.5s | Valid: time= 11.3s loss=0.476, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 58.8s | Valid: time= 12.3s loss=0.994, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 61.5s | Valid: time= 12.7s loss=0.895, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 60.1s | Valid: time= 12.4s loss=0.725, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 61.0s | Valid: time= 12.2s loss=0.490, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 59.5s | Valid: time= 12.5s loss=1.276, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 61.8s | Valid: time= 12.6s loss=0.429, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 61.6s | Valid: time= 12.3s loss=0.745, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 62.7s | Valid: time= 12.8s loss=0.425, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 61.0s | Valid: time= 12.8s loss=0.576, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 62.0s | Valid: time= 12.4s loss=0.625, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 58.6s | Valid: time= 12.5s loss=0.441, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 57.8s | Valid: time= 11.5s loss=0.547, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 59.1s | Valid: time= 11.6s loss=0.439, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 62.0s | Valid: time= 11.4s loss=0.468, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 57.8s | Valid: time= 12.7s loss=0.422, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 61.9s | Valid: time= 12.6s loss=0.700, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 59.7s | Valid: time= 11.7s loss=0.558, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 61.8s | Valid: time= 13.0s loss=0.713, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 60.1s | Valid: time= 12.2s loss=0.449, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 61.7s | Valid: time= 12.5s loss=0.545, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 61.2s | Valid: time= 12.5s loss=0.415, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 60.3s | Valid: time= 12.2s loss=0.370, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 59.2s | Valid: time= 11.9s loss=0.358, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 56.5s | Valid: time= 11.7s loss=0.376, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 55.4s | Valid: time= 11.6s loss=0.396, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 55.2s | Valid: time= 11.7s loss=0.366, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 56.9s | Valid: time= 11.4s loss=0.364, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 56.2s | Valid: time= 11.4s loss=0.368, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 56.8s | Valid: time= 11.7s loss=0.363, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 56.4s | Valid: time= 11.4s loss=0.376, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 56.4s | Valid: time= 12.0s loss=0.377, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 57.0s | Valid: time= 11.6s loss=0.357, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 59.0s | Valid: time= 13.1s loss=0.372, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 65.5s | Valid: time= 13.5s loss=0.392, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 67.0s | Valid: time= 14.0s loss=0.365, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 65.8s | Valid: time= 13.5s loss=0.377, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 120 train exemplars, time= 95.1s
| Constructed 180 exemplars
Final memory length:  100
self.logits length and one shape:  100 (7,)
Previous classes:  [0 1 2 3 4]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=4.817 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  5.1%, forg= 80.5% <<<
>>> Test on task  1 : loss=0.586 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 91.9%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_0
************************************************************************************************************
Task  2
************************************************************************************************************
 Epoch: 1 | Train: time= 64.3s | Valid: time= 13.2s loss=0.280, TAw acc=  0.0% |
 Epoch: 2 | Train: time= 63.2s | Valid: time= 13.1s loss=0.262, TAw acc=  0.0% |
 Epoch: 3 | Train: time= 64.1s | Valid: time= 13.0s loss=0.861, TAw acc=  0.0% |
 Epoch: 4 | Train: time= 62.4s | Valid: time= 11.7s loss=0.058, TAw acc=  0.0% |
 Epoch: 5 | Train: time= 58.2s | Valid: time= 11.7s loss=0.046, TAw acc=  0.0% |
 Epoch: 6 | Train: time= 56.7s | Valid: time= 11.4s loss=1.210, TAw acc=  0.0% |
 Epoch: 7 | Train: time= 57.9s | Valid: time= 11.6s loss=0.069, TAw acc=  0.0% |
 Epoch: 8 | Train: time= 57.3s | Valid: time= 11.7s loss=9.456, TAw acc=  0.0% |
 Epoch: 9 | Train: time= 57.5s | Valid: time= 11.5s loss=0.037, TAw acc=  0.0% |
 Epoch: 10 | Train: time= 57.4s | Valid: time= 12.1s loss=0.007, TAw acc=  0.0% |
 Epoch: 11 | Train: time= 55.5s | Valid: time= 12.2s loss=0.017, TAw acc=  0.0% |
 Epoch: 12 | Train: time= 57.1s | Valid: time= 11.8s loss=0.005, TAw acc=  0.0% |
 Epoch: 13 | Train: time= 57.8s | Valid: time= 11.5s loss=26.168, TAw acc=  0.0% |
 Epoch: 14 | Train: time= 57.0s | Valid: time= 12.3s loss=0.004, TAw acc=  0.0% |
 Epoch: 15 | Train: time= 56.8s | Valid: time= 11.7s loss=0.001, TAw acc=  0.0% |
 Epoch: 16 | Train: time= 57.9s | Valid: time= 11.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 17 | Train: time= 54.9s | Valid: time= 11.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 18 | Train: time= 58.3s | Valid: time= 11.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 19 | Train: time= 57.7s | Valid: time= 11.7s loss=0.001, TAw acc=  0.0% |
 Epoch: 20 | Train: time= 58.3s | Valid: time= 11.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 21 | Train: time= 55.9s | Valid: time= 11.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 22 | Train: time= 59.3s | Valid: time= 12.0s loss=0.000, TAw acc=  0.0% |
 Epoch: 23 | Train: time= 58.0s | Valid: time= 12.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 24 | Train: time= 58.5s | Valid: time= 11.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 25 | Train: time= 60.7s | Valid: time= 12.1s loss=0.001, TAw acc=  0.0% |
 Epoch: 26 | Train: time= 58.2s | Valid: time= 11.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 27 | Train: time= 58.6s | Valid: time= 11.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 28 | Train: time= 55.4s | Valid: time= 12.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 29 | Train: time= 58.3s | Valid: time= 12.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 30 | Train: time= 58.8s | Valid: time= 12.0s loss=0.165, TAw acc=  0.0% |
 Epoch: 31 | Train: time= 60.6s | Valid: time= 12.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 32 | Train: time= 58.8s | Valid: time= 12.3s loss=0.001, TAw acc=  0.0% |
 Epoch: 33 | Train: time= 60.7s | Valid: time= 12.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 34 | Train: time= 61.6s | Valid: time= 12.4s loss=0.001, TAw acc=  0.0% |
 Epoch: 35 | Train: time= 60.9s | Valid: time= 12.5s loss=0.001, TAw acc=  0.0% |
 Epoch: 36 | Train: time= 60.5s | Valid: time= 12.1s loss=0.001, TAw acc=  0.0% |
 Epoch: 37 | Train: time= 61.1s | Valid: time= 12.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 38 | Train: time= 59.7s | Valid: time= 12.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 39 | Train: time= 59.2s | Valid: time= 11.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 40 | Train: time= 56.4s | Valid: time= 11.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 41 | Train: time= 55.9s | Valid: time= 11.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 42 | Train: time= 56.7s | Valid: time= 11.6s loss=0.001, TAw acc=  0.0% |
 Epoch: 43 | Train: time= 57.1s | Valid: time= 11.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 44 | Train: time= 57.1s | Valid: time= 11.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 45 | Train: time= 56.2s | Valid: time= 11.8s loss=0.001, TAw acc=  0.0% |
 Epoch: 46 | Train: time= 56.7s | Valid: time= 11.7s loss=0.001, TAw acc=  0.0% |
 Epoch: 47 | Train: time= 57.1s | Valid: time= 11.9s loss=0.001, TAw acc=  0.0% |
 Epoch: 48 | Train: time= 57.4s | Valid: time= 11.7s loss=0.001, TAw acc=  0.0% |
 Epoch: 49 | Train: time= 56.2s | Valid: time= 11.7s loss=0.001, TAw acc=  0.0% |
 Epoch: 50 | Train: time= 57.3s | Valid: time= 12.1s loss=0.001, TAw acc=  0.0% |
--------------------------------------------------
--------------------------------------------------
| Selected 120 train exemplars, time= 75.7s
| Constructed 220 exemplars
Final memory length:  140
self.logits length and one shape:  140 (7,)
Previous classes:  [0 1 2 3 4 5 6]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=8.712 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 85.6% <<<
>>> Test on task  1 : loss=9.010 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 91.9% <<<
>>> Test on task  2 : loss=0.016 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:100.0%, forg=  0.0% <<<
Save at ./results/20241119_der_csl/ham10000/ham10000_der_split_dp_grow_csl_0
************************************************************************************************************
TAw Acc
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Acc result
 0.00	 0.00	
************************************************************************************************************
TAg Acc
	85.56%  0.00%  0.00% 	Avg.:85.56% 
	 5.10% 91.92%  0.00% 	Avg.:48.51% 
	 0.00%  0.00% 100.00% 	Avg.:33.33% 
TAg Acc result
85.56	48.51	33.33	
************************************************************************************************************
TAw Forg
	 0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Forg result
 0.00	 0.00	
************************************************************************************************************
TAg Forg
	 0.00%  0.00%  0.00% 
	80.45%  0.00%  0.00% 	Avg.:80.45% 
	85.56% 91.92%  0.00% 	Avg.:88.74% 
TAg Forg result
80.45	88.74	
************************************************************************************************************
[Elapsed time = 3.6 h]
Done!
