Using downloaded and verified file: ./data/bloodmnist/bloodmnist.npz
Using downloaded and verified file: ./data/bloodmnist/bloodmnist.npz
Taskcla:  [(0, 2), (1, 2), (2, 2), (3, 2)]
Number of clients each task:  [10, 10, 10, 10]
************************************************************************************************************
Task  0
************************************************************************************************************
 Epoch: 1 | Train: time= 13.9s | Valid: time=  4.6s loss=0.345, TAw acc=  0.0% |
 Epoch: 2 | Train: time=  9.4s | Valid: time=  4.6s loss=0.093, TAw acc=  0.0% |
num_cls : 2
num_exemplars:  600
original_exemplars_per_class:  300
--------------------------------------------------
--------------------------------------------------
| Selected 598 train exemplars, time= 33.9s
| Constructed 598 exemplars
Final memory length:  200
self.logits length and one shape:  200 (8,)
Previous classes:  [0 1]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=0.062 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 98.2%, forg=  0.0% <<<
Save at ./results/test/bloodmnist_der_split_dp_fixd_csl_0
************************************************************************************************************
Task  1
************************************************************************************************************
 Epoch: 1 | Train: time=  8.5s | Valid: time=  4.2s loss=0.406, TAw acc=  0.0% |
 Epoch: 2 | Train: time=  8.3s | Valid: time=  4.1s loss=0.399, TAw acc=  0.0% |
num_cls : 4
num_exemplars:  600
original_exemplars_per_class:  150
--------------------------------------------------
--------------------------------------------------
| Selected 299 train exemplars, time= 16.5s
| Constructed 499 exemplars
Final memory length:  198
self.logits length and one shape:  198 (8,)
Previous classes:  [0 1 2 3]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=1.920 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 39.3%, forg= 58.9% <<<
>>> Test on task  1 : loss=0.457 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 88.7%, forg=  0.0% <<<
Save at ./results/test/bloodmnist_der_split_dp_fixd_csl_0
************************************************************************************************************
Task  2
************************************************************************************************************
 Epoch: 1 | Train: time=  6.7s | Valid: time=  4.1s loss=1.278, TAw acc=  0.0% |
 Epoch: 2 | Train: time=  6.7s | Valid: time=  4.0s loss=1.447, TAw acc=  0.0% |
num_cls : 6
num_exemplars:  600
original_exemplars_per_class:  100
--------------------------------------------------
--------------------------------------------------
| Selected 197 train exemplars, time=  9.7s
| Constructed 395 exemplars
Final memory length:  199
self.logits length and one shape:  199 (8,)
Previous classes:  [0 1 2 3 4 5]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=2.857 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.5%, forg= 97.8% <<<
>>> Test on task  1 : loss=2.476 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.4%, forg= 88.3% <<<
>>> Test on task  2 : loss=1.469 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 57.0%, forg=  0.0% <<<
Save at ./results/test/bloodmnist_der_split_dp_fixd_csl_0
************************************************************************************************************
Task  3
************************************************************************************************************
 Epoch: 1 | Train: time=  6.4s | Valid: time=  4.0s loss=1.575, TAw acc=  0.0% |
 Epoch: 2 | Train: time=  6.4s | Valid: time=  3.9s loss=2.716, TAw acc=  0.0% |
num_cls : 8
num_exemplars:  600
original_exemplars_per_class:  75
--------------------------------------------------
--------------------------------------------------
| Selected 149 train exemplars, time=  7.8s
| Constructed 348 exemplars
Final memory length:  194
self.logits length and one shape:  194 (8,)
Previous classes:  [0 1 2 3 4 5 6 7]
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=5.372 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 98.2% <<<
>>> Test on task  1 : loss=4.989 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 88.7% <<<
>>> Test on task  2 : loss=4.416 | TAw acc=  0.0%, forg=  0.0%| TAg acc=:  0.0%, forg= 57.0% <<<
>>> Test on task  3 : loss=3.323 | TAw acc=  0.0%, forg=  0.0%| TAg acc=: 38.1%, forg=  0.0% <<<
Save at ./results/test/bloodmnist_der_split_dp_fixd_csl_0
************************************************************************************************************
TAw Acc
	 0.00%  0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Acc result
 0.00	 0.00	 0.00	
************************************************************************************************************
TAg Acc
	98.25%  0.00%  0.00%  0.00% 	Avg.:98.25% 
	39.33% 88.67%  0.00%  0.00% 	Avg.:64.00% 
	 0.46%  0.39% 57.01%  0.00% 	Avg.:19.29% 
	 0.00%  0.00%  0.00% 38.12% 	Avg.: 9.53% 
TAg Acc result
98.25	64.00	19.29	 9.53	
************************************************************************************************************
TAw Forg
	 0.00%  0.00%  0.00%  0.00% 
	 0.00%  0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00%  0.00% 	Avg.: 0.00% 
	 0.00%  0.00%  0.00%  0.00% 	Avg.: 0.00% 
TAw Forg result
 0.00	 0.00	 0.00	
************************************************************************************************************
TAg Forg
	 0.00%  0.00%  0.00%  0.00% 
	58.92%  0.00%  0.00%  0.00% 	Avg.:58.92% 
	97.79% 88.28%  0.00%  0.00% 	Avg.:93.04% 
	98.25% 88.67% 57.01%  0.00% 	Avg.:81.31% 
TAg Forg result
58.92	93.04	81.31	
************************************************************************************************************
[Elapsed time = 0.1 h]
Done!
